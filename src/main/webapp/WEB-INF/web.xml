<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee"
 xmlns:jsp="http://java.sun.com/xml/ns/javaee/jsp" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" 
 xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5">
  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/conf/UMTContext.xml</param-value>
  </context-param>
  <context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>/WEB-INF/conf/log4j.properties</param-value>
  </context-param>
  <context-param>
    <param-name>webAppRootKey</param-name>
    <param-value>umt.root</param-value>
  </context-param>
  <session-config>
    <session-timeout>720</session-timeout>
  </session-config>
  <context-param>
    <param-name>uafVerifyClass</param-name>
    <param-value>cn.vlabs.umt.ui.rest.uaf.UafVerifyUserServiceImpl</param-value>
  </context-param>
  <context-param>
    <param-name>uafRegisterClass</param-name>
    <param-value>cn.vlabs.umt.ui.rest.uaf.RestRegiserServiceImpl</param-value>
  </context-param>
  <context-param>
    <param-name>version-file</param-name>
    <param-value>/WEB-INF/conf/version.txt</param-value>
  </context-param>
  <listener>
    <listener-class>org.springframework.web.util.WebAppRootListener</listener-class>
  </listener>
  <listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
  </listener>
  <listener>
    <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
  </listener>
  <servlet>
    <servlet-name>mvcServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
      <param-name>contextConfigLocation</param-name>
      <param-value>classpath:servlet-context.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>mvcServlet</servlet-name>
    <url-pattern>/</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>uafServices</servlet-name>
    <servlet-class>cn.vlabs.rest.server.ServiceServlet</servlet-class>
    <init-param>
      <description>这个是Rest Service 框架的配置文件。</description>
      <param-name>config</param-name>
      <param-value>WEB-INF/conf/Rest2Services.xml</param-value>
    </init-param>
    <init-param>
      <param-name>version</param-name>
      <param-value>1.0</param-value>
    </init-param>
    <init-param>
      <param-name>charset</param-name>
      <param-value>utf-8</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>uafServices</servlet-name>
    <url-pattern>/uafServices</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>jcaptcha</servlet-name>
    <servlet-class>com.octo.captcha.module.servlet.image.SimpleImageCaptchaServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>jcaptcha</servlet-name>
    <url-pattern>/validcode.jpg</url-pattern>
  </servlet-mapping>
  <filter>
    <filter-name>LoginFilter</filter-name>
    <filter-class>cn.vlabs.umt.ui.servlet.filters.LoginFilter</filter-class>
  </filter>
  <filter>
    <filter-name>IdpAPIFilter</filter-name>
    <filter-class>cn.vlabs.umt.ui.restfullapi.IdpApiIpFilter</filter-class>
  </filter>
  <filter>
    <filter-name>LoginOnlyFilter</filter-name>
    <filter-class>cn.vlabs.umt.ui.servlet.filters.LoginOnlyFilter</filter-class>
  </filter>
  <filter>
    <filter-name>ReadonlyFilter</filter-name>
    <filter-class>cn.vlabs.umt.ui.servlet.filters.ReadonlyFilter</filter-class>
    <init-param>
    	<param-name>ignore</param-name>
    	<param-value>/jq/validate.do;/services;/request/loginToken;/ouath2/token;/oauth2/authorize;/oauth2/token;/js;/thirdparty;/css;/images;/dface;/index.jsp;/login;/logout;/help.jsp;/help_oauth.jsp;/help_updatelog.jsp;/help_browser_password.jsp;/help_https.jsp</param-value>
    </init-param>
  </filter>
  <filter>
    <filter-name>CharsetFilter</filter-name>
    <filter-class>cn.vlabs.umt.ui.servlet.filters.CharacterFilter</filter-class>
    <init-param>
      <param-name>charset</param-name>
      <param-value>UTF-8</param-value>
    </init-param>
  </filter>
  <filter>
    <filter-name>P3PConfigFilter</filter-name>
    <filter-class>cn.vlabs.umt.ui.servlet.filters.P3PConfigFilter</filter-class>
    <init-param>
      <param-name>p3pConfig</param-name>
      <param-value>CP=&quot;IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT&quot;</param-value>
    </init-param>
  </filter>
  <filter>
    <filter-name>AdminFilter</filter-name>
    <filter-class>cn.vlabs.umt.ui.servlet.filters.AdminFilter</filter-class>
  </filter>
  <filter>
    <filter-name>XssFilter</filter-name>
    <filter-class>cn.vlabs.umt.ui.servlet.filters.XssFilter</filter-class>
    <init-param>
      <param-name>SplitChar</param-name>
      <param-value>@</param-value>
    </init-param>
    <init-param>
      <param-name>FilterChar</param-name>
      <param-value>'@&quot;@\@#@%@></param-value>
    </init-param>
    <init-param>
      <param-name>ReplaceChar</param-name>
      <param-value>\'@\&quot;@＼@＃@\\%@＞</param-value>
    </init-param>
    <init-param>
      <param-name>NeverInput</param-name>
      <param-value>RequestXML@password@retype@oldpassword@pubCert</param-value>
    </init-param>
    <init-param>
      <param-name>IgnoreInput</param-name>
      <param-value>WebServerURL@state@returnUrl</param-value>
    </init-param>
    <init-param>
      <param-name>XssConf</param-name>
      <param-value>xss.conf</param-value>
    </init-param>
  </filter>
  <filter>
    <description>
		</description>
    <display-name>APITokenFilter</display-name>
    <filter-name>APITokenFilter</filter-name>
    <filter-class>cn.vlabs.umt.ui.jsapi.APITokenFilter</filter-class>
  </filter>
  <filter>
    <filter-name>CAS Authentication Filter</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    <init-param>
        <param-name>targetBeanName</param-name>
        <param-value>authenticationFilter</param-value>
    </init-param>
  </filter>
  <filter>
    <filter-name>CAS Validation Filter</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    <init-param>
        <param-name>targetBeanName</param-name>
        <param-value>ticketValidationFilter</param-value>
    </init-param>
  </filter>
  <filter>  
    <filter-name>CAS HttpServletRequest Wrapper Filter</filter-name>  
    <filter-class>org.jasig.cas.client.util.HttpServletRequestWrapperFilter</filter-class>  
  </filter>  
  <servlet>
    <servlet-name>LoginServlet</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.LoginServlet</servlet-class>
  </servlet>
  <servlet>
    <servlet-name>LogoutServlet</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.LogoutServlet</servlet-class>
  </servlet>
  <servlet>
    <servlet-name>ServiceServlet</servlet-name>
    <servlet-class>cn.vlabs.rest.server.ServiceServlet</servlet-class>
    <init-param>
      <description>这个是Rest Service 框架的配置文件。</description>
      <param-name>config</param-name>
      <param-value>/WEB-INF/conf/services.xml</param-value>
    </init-param>
  </servlet>
  <servlet>
    <servlet-name>Services</servlet-name>
    <servlet-class>cn.vlabs.rest.server.ServiceServlet</servlet-class>
    <init-param>
      <description>这个是Rest Service 框架的配置文件。</description>
      <param-name>config</param-name>
      <param-value>WEB-INF/conf/Rest2Services.xml</param-value>
    </init-param>
    <init-param>
      <param-name>version</param-name>
      <param-value>1.0</param-value>
    </init-param>
    <init-param>
      <param-name>charset</param-name>
      <param-value>utf-8</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet>
    <servlet-name>LoginThirdPartyApp</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.LoginThirdPartyApp</servlet-class>
  </servlet>
  <servlet>
    <servlet-name>OnlineStorageLoginServlet</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.OnlineStorageLoginServlet</servlet-class>
    <init-param>
      <param-name>onlineStorageURL</param-name>
      <param-value>http://HOST/coremail/XPS/nf/list.jsp?disableWhole=yes</param-value>
    </init-param>
  </servlet>
  <servlet>
    <servlet-name>GeoServlet</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.GeoLoginServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>GeoServlet</servlet-name>
    <url-pattern>/geo</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>LoginServlet</servlet-name>
    <url-pattern>/login</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>LogoutServlet</servlet-name>
    <url-pattern>/logout</url-pattern>
  </servlet-mapping>

  <servlet-mapping>
    <servlet-name>ServiceServlet</servlet-name>
    <url-pattern>/ServiceServlet</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>Services</servlet-name>
    <url-pattern>/services</url-pattern>
  </servlet-mapping>
  <filter-mapping>
    <filter-name>CharsetFilter</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>XssFilter</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>P3PConfigFilter</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>LoginFilter</filter-name>
    <url-pattern>/user/*</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>LoginOnlyFilter</filter-name>
    <url-pattern>/needLogin/*</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>LoginFilter</filter-name>
    <url-pattern>/index.jsp</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>AdminFilter</filter-name>
    <url-pattern>/admin/*</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>APITokenFilter</filter-name>
    <url-pattern>/api/*</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>IdpAPIFilter</filter-name>
    <url-pattern>/api-idp/*</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>CAS Authentication Filter</filter-name>
    <url-pattern>/geo</url-pattern>
</filter-mapping>
  <filter-mapping>
    <filter-name>CAS Validation Filter</filter-name>
    <url-pattern>/geo</url-pattern>
</filter-mapping>
 <filter-mapping>  
    <filter-name>CAS HttpServletRequest Wrapper Filter</filter-name>  
    <url-pattern>/geo</url-pattern>  
  </filter-mapping>  
 <filter-mapping>  
    <filter-name>ReadonlyFilter</filter-name>  
    <url-pattern>/*</url-pattern>  
  </filter-mapping>  
  <listener>
    <description>Version file reader</description>
    <listener-class>net.duckling.falcon.api.mstatic.VersionStartupListener</listener-class>
  </listener>
  <listener>
    <listener-class>cn.vlabs.umt.ui.UMTStartupListener</listener-class>
  </listener>
  <servlet-mapping>
    <servlet-name>LoginThirdPartyApp</servlet-name>
    <url-pattern>/user/loginThirdPartyApp</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>OnlineStorageLoginServlet</servlet-name>
    <url-pattern>/user/onlineStorageLoginServlet</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>WebSSO</servlet-name>
    <servlet-class>cn.dacas.websso.LoginServlet</servlet-class>
    <init-param>
      <param-name>webLoginUri</param-name>
      <param-value>https://HOST/</param-value>
    </init-param>
    <init-param>
      <param-name>appId</param-name>
      <param-value>email</param-value>
    </init-param>
    <init-param>
      <param-name>appKey</param-name>
      <param-value>APP_KEY</param-value>
    </init-param>
    <init-param>
      <param-name>loginRedirect</param-name>
      <param-value>/thirdParty/callback/cashq</param-value>
    </init-param>
    <init-param>
      <param-name>webLoginCert</param-name>
      <param-value>
            	APP_CERT
            </param-value>
    </init-param>
  </servlet>
  <servlet-mapping>
    <servlet-name>WebSSO</servlet-name>
    <url-pattern>/cashq</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>SinaWeiboCallBack</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.SinaWeiboCallBackServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>SinaWeiboCallBack</servlet-name>
    <url-pattern>/thirdParty/callback/sina</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>QQCallBack</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.QQCallBackServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>QQCallBack</servlet-name>
    <url-pattern>/thirdParty/callback/qq</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>WeiXinCallBack</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.WeiXinCallBackServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>WeiXinCallBack</servlet-name>
    <url-pattern>/thirdParty/callback/weixin</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>CashqSsoCallBack</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.CashqSsoCallBackServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>CashqSsoCallBack</servlet-name>
    <url-pattern>/thirdParty/callback/cashq</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>UafCallBack</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.UafCallBackServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>UafCallBack</servlet-name>
    <url-pattern>/thirdParty/callback/uaf</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>TempTokenServlet</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.LoginTokenServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>TempTokenServlet</servlet-name>
    <url-pattern>/request/loginToken</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>RouteServlet</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.RouteServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>RouteServlet</servlet-name>
    <url-pattern>/route</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>authorization</servlet-name>
    <servlet-class>cn.vlabs.umt.ui.servlet.AuthorizationCodeServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>authorization</servlet-name>
    <url-pattern>/oauth2/authorize</url-pattern>
  </servlet-mapping>
  <servlet>
    <servlet-name>restfulApi</servlet-name>
    <servlet-class>
			cn.vlabs.umt.ui.servlet.RestFulAPIServlet
		</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>restfulApi</servlet-name>
    <url-pattern>/rest/api</url-pattern>
  </servlet-mapping>
  <welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
  </welcome-file-list>
</web-app>